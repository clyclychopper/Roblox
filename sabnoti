--// PERFORMANCE OPTIMIZATION BLOCK (inject at top, runs before everything)
do
    -- FPS Cap at 20
    local RunService = game:GetService("RunService")
    local Settings = settings()

    -- Cap FPS to 20 (balance between performance and reliability)
    pcall(function()
        Settings.Rendering.FrameRateManager = Enum.FrameRateManagerMode.Off
    end)

    -- Use shared fps cap method - 20 FPS for reliable event processing
    if setfpscap then
        pcall(setfpscap, 20)
    end

    -- Reduce rendering quality aggressively
    pcall(function()
        local ls = game:GetService("Lighting")
        ls.GlobalShadows = false
        ls.FogEnd = 9e9
        ls.FogStart = 9e9
        ls.Brightness = 2
    end)

    pcall(function()
        local ws = game:GetService("Workspace")
        ws.StreamingEnabled = false

        -- Disable terrain decorations
        local terrain = ws:FindFirstChildOfClass("Terrain")
        if terrain then
            terrain.Decoration = false
            terrain.WaterWaveSize = 0
            terrain.WaterWaveSpeed = 0
            terrain.WaterReflectance = 0
            terrain.WaterTransparency = 0
        end
    end)

    -- Quality settings
    pcall(function()
        Settings.Rendering.QualityLevel = Enum.QualityLevel.Level01
        Settings.Rendering.MeshPartDetailLevel = Enum.MeshPartDetailLevel.Level01
        Settings.Rendering.EditorQualityLevel = Enum.QualityLevel.Level01
    end)

    -- AGGRESSIVE 3D RENDERING DISABLE (WHITE SCREEN MODE)
    pcall(function()
        local ws = game:GetService("Workspace")
        local cam = ws.CurrentCamera
        
        -- Method 1: Disable 3D rendering directly
        ws["3DRenderingEnabled"] = false
        
        -- Method 2: Set camera to blank part
        local blankPart = Instance.new("Part")
        blankPart.Anchored = true
        blankPart.CanCollide = false
        blankPart.Transparency = 1
        blankPart.Size = Vector3.new(1, 1, 1)
        blankPart.Position = Vector3.new(0, 10000, 0)
        blankPart.Parent = ws
        
        if cam then
            cam.CameraType = Enum.CameraType.Scriptable
            cam.CFrame = CFrame.new(0, 10000, 0)
            cam.FieldOfView = 1
        end
        
        -- Method 3: Destroy all visible parts
        for _, obj in ipairs(ws:GetDescendants()) do
            if obj:IsA("BasePart") and obj.Parent ~= blankPart then
                obj.Transparency = 1
            end
        end
        
        print("[PERF] ðŸ”² WHITE SCREEN MODE: ENABLED")
    end)

    print("[PERF] âœ… Performance optimizations applied: FPS=20, shadows off, quality reduced")
    print("[PERF] ðŸ”² WHITE SCREEN MODE: Active (3D rendering disabled)")
    print("[PERF] âš¡ FPS kept at 20 for reliable webhook/scanning performance")
end

--// SETTINGS
repeat task.wait() until game:IsLoaded()

local plotsFolder = workspace:FindFirstChild("Plots")
if not plotsFolder then
    warn("âš ï¸ Plots folder not found, waiting...")
    plotsFolder = workspace:WaitForChild("Plots", 30)
    if not plotsFolder then
        error("âŒ Plots folder never appeared!")
    end
end

local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
if not player then
    player = Players.PlayerAdded:Wait()
end

local WEBHOOK_1 = getgenv().Webhook1 or error("âŒ Webhook1 not set!")  -- 10m-50m (no ping)
local WEBHOOK_2 = getgenv().Webhook2 or error("âŒ Webhook2 not set!")  -- 50m+ (@everyone if 500m+ or ping names)
local WEBHOOK_3 = getgenv().Webhook3 or error("âŒ Webhook3 not set!")  -- 1b+ only (always @everyone)
local WEBHOOK_ERROR = getgenv().WebhookError or error("âŒ WebhookError not set!")  -- error logs

-- Validate webhook URLs
local function validateWebhook(url, name)
    if not url or type(url) ~= "string" then
        error(name .. " is not a string")
    end
    if not url:match("^https://discord%.com/api/webhooks/") and not url:match("^https://discordapp%.com/api/webhooks/") then
        error(name .. " is not a valid Discord webhook URL")
    end
    return url
end

-- Clean and validate webhooks
local function cleanWebhook(url)
    -- Remove any whitespace, newlines, or invisible characters
    url = url:gsub("%s+", "")
    url = url:gsub("[\r\n]", "")
    return url
end

WEBHOOK_1 = cleanWebhook(WEBHOOK_1)
WEBHOOK_2 = cleanWebhook(WEBHOOK_2)
WEBHOOK_3 = cleanWebhook(WEBHOOK_3)
WEBHOOK_ERROR = cleanWebhook(WEBHOOK_ERROR)

WEBHOOK_1 = validateWebhook(WEBHOOK_1, "Webhook1")
WEBHOOK_2 = validateWebhook(WEBHOOK_2, "Webhook2")
WEBHOOK_3 = validateWebhook(WEBHOOK_3, "Webhook3")
WEBHOOK_ERROR = validateWebhook(WEBHOOK_ERROR, "WebhookError")

-- Firebase configuration
local FIREBASE_URL = "https://clynotify-default-rtdb.asia-southeast1.firebasedatabase.app"
local FIREBASE_ENABLED = true

-- Debug: Print webhook info (first 50 chars only for security)
print("[Config] âœ… All 4 webhooks configured (3 main + 1 error log)")
print("[Config] WH1 starts with:", WEBHOOK_1:sub(1, 50))
print("[Config] WH1 length:", #WEBHOOK_1, "chars")
print("[Config] Player:", player.Name)
print("[Config] Plots found:", #plotsFolder:GetChildren())
local MIN_INCOME = 10000000      -- 10m minimum
local MID_THRESHOLD = 50000000   -- 50m (WH2 starts here)
local HIGH_THRESHOLD = 200000000 -- 200m (auto-ping threshold)
local BILLION_THRESHOLD = 800000000  -- 800m (WH3 threshold)
local SEND_DELAY = 2
local HIGH_VALUE_THRESHOLD = 100000000  -- 100m (hop trigger)

local MAX_PLAYERS = 8
local HOP_INTERVAL = 60  -- 1 minute


-- Bot usernames to avoid (will hop if detected)
local BOT_USERNAMES = {
    ["Nor4crewHQgames11"] = true,
    ["LadyLucasrbxDev"] = true,
    ["miniRileyliamProJax"] = true,
    ["Calebcrafts77"] = true,
    ["TurboSirZo3crafts521"] = true,
    ["BravezagedinoRBLX13"] = true,
    ["RubyClanYTDash51"] = true,
    ["SneakyCalebnat1on200"] = true,
    ["Ggigaraven"] = true,
    ["g4mingFuzzyM0oseKid"] = true,
    ["TurbomaxdragonPro80"] = true,
    ["AriharperYT"] = true,
    ["plGold3nDolphinPlayz"] = true,
    ["P1xelchloe41"] = true,
    ["ChloecodezRBX"] = true,
    ["EpicZanedrawsGaming3"] = true,
    ["Goldenkoala63"] = true,
    ["l3ozquaad"] = true,
    ["k4ydengamestv256"] = true,
    ["LunaCreates52"] = true,
    ["SilentsharkPlayz"] = true,
    ["L3osk4teschill2015"] = true,
    ["Ultr4skymiaPlays"] = true,
    ["rubyrbxnationPro22"] = true,
    ["HarperdrawsDevcrafts"] = true,
    ["re4lAriagamesPlayz"] = true,
    ["Rubystreams56"] = true,
    ["IsabellaSStudioPlayz"] = true,
    ["Turbop3nguin75"] = true,
    ["Sirh4z3lcraftsrblx28"] = true,
    ["capta1nRileykoala"] = true,
    ["itsKayd3nBloxFam"] = true,
    ["TheFuzzypenguingirlr"] = true,
    ["Ol1viaDraws82"] = true,
    ["RealNoranaationPlayz"] = true,
    ["kaiisabellaGaming853"] = true,
    ["MiabloxRBX60"] = true,
    ["LilHazelztreams"] = true,
    ["Embercrafts48"] = true,
    ["Officialnoahskat3s97"] = true,
    ["Mil0editsRaven"] = true,
    ["MrsgoldenravenboyBlo"] = true,
    ["finnJackzonytPixel"] = true,
    ["r3CrimsonPenguinBlox"] = true,
    ["SageSquadbunny30"] = true,
    ["finngrayzonn40"] = true,
    ["EthanNationrapid12"] = true,
    ["Emberreditzquantum"] = true,
    ["Ch1lldolphingirlRBLX"] = true,
    ["EthaanplayzDev58"] = true,
    ["NoahrbxcluubDev"] = true,
    ["l1amplayzgames61"] = true,
    ["AriclanVib3s"] = true,
}

local currentHopTimer = nil
local isHopping = false  -- Prevent multiple simultaneous hops
local pendingHighValueHop = false  -- Flag to hop after webhook sends

local PING_NAMES = {
    ["Rosetti Tualetti"] = true,
    ["Rosey and Teddy"] = true,
    ["Los Amigos"] = true,
    ["Smurf Cat"] = true,
    ["John Pork"] = true,
    ["Dragon Cannelloni"] = true,
    ["Meowl"] = true,
    ["Strawberry Elephant"] = true,
    ["Fragrama and Chocrama"] = true,
    ["Ketupat Kepat"] = true,
    ["Tang Tang Kelentang"] = true,
    ["La Secret Combinasion"] = true,
    ["Los Bros"] = true,
    ["Los Hotspotsitos"] = true,
    ["Spaghetti Tualetti"] = true,
    ["Tralaledon"] = true,
    ["Ketchuru and Masturu"] = true,
    ["Garama and Madundung"] = true,
    ["Nuclearo Dinosauro"] = true,
    ["Los Tacoritas"] = true,
    ["Tictac Sahur"] = true,
    ["La Supreme Combinasion"] = true,
    ["Los Combinasionas"] = true,
    ["La Casa Boo"] = true,
    ["Los Spooky Combinasionas"] = true,
    ["Reinito Sleighito"] = true,
    ["Sammyni Fattini"] = true,
    ["Ketupat Bros"] = true,
    ["Burguro And Fryuro"] = true,
    ["Lavadorito Spinito"] = true,
    ["Hydra Dragon Cannelloni"] = true,
    ["Dragon Gingerini"] = true,
    ["Spooky and Pumpky"] = true,
    ["Cerberus"] = true,
    ["Popcuru and Fizzuru"] = true,
    ["Swaggy Bros"] = true,
    ["Orcaledon"] = true,
    ["Eviledon"] = true,
    ["Cooki and Milki"] = true,
    ["Capitano Moby"] = true,
    ["Headless Horseman"] = true,
    ["Noo my Heart"] = true

}

local brainrots = {
-- God
"Swaggy Bros",
"Sammyni Fattini",
"La Food Combinasion",
"Los Sekolahs",
"Smurf Cat",
"John Pork",
"Tim Cheese",
"Fizzy Soda",
"Cocofanto Elefanto",
"Antonio",
"Girafa Celestre",
"Gattatino Nyanino",
"Gattatino Neonino",
"Chihuanini Taconini",
"Matteo",
"Tralalero Tralala",
"Los Crocodillitos",
"Tigroligre Frutonni",
"Odin Din Din Dun",
"Orcalero Orcala",
"Money Money Man",
"Alessio",
"Unclito Samito",
"Statutino Libertino",
"Tipi Topi Taco",
"Tralalita Tralala",
"Tukanno Banana",
"Extinct Ballerina",
"Vampira Cappucina",
"Espresso Signora",
"Trenozosturzzo Turbo 3000",
"Bulbito Bandito Traktorito",
"Urubini Flamenguini",
"Jacko Jack Jack",
"Trippi Troppi Troppa Trippa",
"Capi Taco",
"Los Chihuaninis",
"Gattito Tacoto",
"Las Capuchinas",
"Ballerino Lololo",
"Los Tungtungtungcitos",
"Pakrahmatmamat",
"Ballerina Peppermintina",
"Piccione Macchina",
"Pakrahmatmatina",
"Los Bombinitos",
"Tractoro Dinosauro",
"Brr Es Teh Patipum",
"Cacasito Satalito",
"Orcalita Orcala",
"Aquanaut",
"Tartaruga Cisterna",
"Snailenzo",
"Corn Corn Corn Sahur",
"Squalanana",
"Mummy Ambalabu",
"Los Orcalitos",
"Dug Dug Dug",
"Ginger Globo",
"Yeti Claus",
"Crabbo Limonetta",
"Los Tipi Tacos",
"Tootini Shrimpini",
"Granchiello Spiritell",
"Frio Ninja",
"Piccionetta Macchina",
"Boba Panda",
"Mastodontico Telepiedone",
"Los Gattitos",
"Bambu Bambu Sahur",
"Chrismasmamat",
"Anpali Babel",
"Cappuccino Clownino",
"Luv Luv Luv",
"Bombardini Tortinii",
"Brasilini Berimbini",
"Belula Beluga",
"Krupuk Pagi Pagi",
"Skull Skull Skull",
"Cocoa Assassino",
"Tentacolo Tecnico",
"Ginger Cisterna",
"Dolphini Jetskini",
"Pop Pop Sahur",
"Noo La Polizia",
"Karkerheart Luvkur",

-- SECRET BRAINROTS
"La Taco Combinasion",
"La Vacca Saturno Saturnita",
"Pandanini Frostini",
"Bisonte Giuppitere",
"Blackhole Goat",
"Jackorilla",
"Agarrini Ia Palini",
"Chachechi",
"Karkerkar Kurkur",
"Los Tortus",
"Los Matteos",
"Sammyni Spyderini",
"Trenostruzzo Turbo 4000",
"Chimpanzini Spiderini",
"Boatito Auratito",
"Fragola La La La",
"Dul Dul Dul",
"La Vacca Prese Presente",
"Frankentteo",
"Los Trios",
"Karker Sahur",
"Torrtuginni Dragonfrutini",
"Los Tralaleritos",
"Zombie Tralala",
"La Cucaracha",
"Vulturino Skeletono",
"Guerriro Digitale",
"Extinct Tralalero",
"Yess My Examine",
"Extinct Matteo",
"Las Tralaleritas",
"Rocco Disco",
"Reindeer Tralala",
"Las Vaquitas Saturnitas",
"Pumpkin Spyderini",
"Job Job Job Sahur",
"Los Karkeritos",
"Graipuss Medussi",
"Santteo",
"La Vacca Jacko Linterino",
"Triplito Tralaleritos",
"Trickolino",
"Giftini Spyderini",
"Los Spyderinis",
"Love Love Love Sahur",
"Perrito Burrito",
"1x1x1x1",
"Los Cucarachas",
"Please My Present",
"Cuadramat and Pakrahmatmamat",
"Los Jobcitos",
"Nooo My Hotspot",
"Pot Hotspot",
"Noo My Examine",
"Telemorte",
"La Sahur Combinasion",
"List List List Sahur",
"To To To Sahur",
"Pirulitoita Bicicletaire",
"25",
"Santa Hotspot",
"Horegini Boom",
"Quesadilla Crocodila",
"Pot Pumpkin",
"Naughty Naughty",
"Cupid Cupid Sahur",
"Ho Ho Ho Sahur",
"Mi Gatito",
"Chicleteira Bicicleteira",
"Cupid Hotspot",
"Spaghetti Tualetti",
"Esok Sekolah",
"Quesadillo Vampiro",
"Brunito Marsito",
"Chill Puppy",
"Burrito Bandito",
"Chicleteirina Bicicleteirina",
"Los Quesadillas",
"Bunito Bunito Spinito",
"Noo My Candy",
"Los Nooo My Hotspotsitos",
"La Grande Combinasion",
"Rang Ring Bus",
"Guest 666",
"Los Mi Gatitos",
"Los Chicleteiras",
"67",
"Donkeyturbo Express",
"Mariachi Corazoni",
"Los Burritos",
"Los 25",
"Swag Soda",
"Noo my Heart",
"Chimnino",
"Los Combinasionas",
"Chicleteira Noelteira",
"Fishino Clownino",
"Tacorita Bicicleta",
"Spinny Hammy",
"Nuclearo Dinosauro",
"Las Sis",
"Chicleteira Cupideira",
"La Karkerkar Combinasion",
"Chillin Chili",
"Chipso and Queso",
"Money Money Reindeer",
"Money Money Puggy",
"Celularcini Viciosini",
"Los Planitos",
"Los Mobilis",
"Los 67",
"Mieteteira Bicicleteira",
"Tuff Toucan",
"La Spooky Grande",
"Los Spooky Combinasionas",
"Los Candies",
"Los Hotspositos",
"Los Jolly Combinasionas",
"Los Puggies",
"W or L",
"Tralalalaledon",
"La Extinct Grande",
"Tralaledon",
"La Jolly Grande",
"Los Primos",
"Bacuru and Egguru",
"Eviledon",
"Los Tacoritas",
"Lovin Rose",
"Tang Tang Kelentang",
"Ketupat Kepat",
"Los Bros",
"Tictac Sahur",
"La Romantic Grande",
"Gingerat Gerat",
"Orcaledon",
"Ketchuru and Masturu",
"Jolly Jolly Sahur",
"Garama and Madundung",
"Rosetti Tualetti",
"Festive 67",
"Love Love Bear",
"La Ginger Sekolah",
"Spooky and Pumpky",
"Lavadorito Spinito",
"Los Spaghettis",
"La Casa Boo",
"Fragrama and Chocrama",
"La Secret Combinasion",
"Reinito Sleighito",
"Ketupat Bros",
"Burguro And Fryuro",
"Cooki and Milki",
"Capitano Moby",
"Rosey and Teddy",
"Popcuru and Fizzuru",
"Cerberus",
"La Supreme Combinasion",
"Dragon Cannelloni",
"Dragon Gingerini",
"Headless Horseman",
"Hydra Dragon Cannelloni",

-- OGS

"Skibidi Toilet",
"Meowl",
"Strawberry Elephant",


}

local RARITY_COLOR = {
    ["God"] = 0xFFD166,
    ["Secret"] = 0xEF476F,
    ["OG"] = 0x118AB2,
    ["Burat"] = 0x06D6A0,
    ["Unknown"] = 0x9E9E9E
}

local RARITY_ORDER = {
    ["OG"] = 5,
    ["Secret"] = 4,
    ["God"] = 3,
    ["Burat"] = 2,
    ["Unknown"] = 1
}

local rarityByName = {

    ["Swaggy Bros"] = "Secret",
    ["Los Amigos"] = "Secret",
    ["Sammyni Fattini"] = "Secret",
    ["Los Sekolahs"] = "Secret",
    ["La Food Combinasion"] = "Secret",
    

    --GOD
    ["Tim Cheese"] = "Burat",
    ["Fizzy Soda"] = "God",
    ["Cocofanto Elefanto"] = "God",
    ["Antonio"] = "God",
    ["Girafa Celestre"] = "God",
    ["Gattatino Nyanino"] = "God",
    ["Gattatino Neonino"] = "God",
    ["Chihuanini Taconini"] = "God",
    ["Matteo"] = "God",
    ["Tralalero Tralala"] = "God",
    ["Los Crocodillitos"] = "God",
    ["Tigroligre Frutonni"] = "God",
    ["Odin Din Din Dun"] = "God",
    ["Orcalero Orcala"] = "God",
    ["Money Money Man"] = "God",
    ["Alessio"] = "God",
    ["Unclito Samito"] = "God",
    ["Statutino Libertino"] = "God",
    ["Tipi Topi Taco"] = "God",
    ["Tralalita Tralala"] = "God",
    ["Tukanno Banana"] = "God",
    ["Extinct Ballerina"] = "God",
    ["Vampira Cappucina"] = "God",
    ["Espresso Signora"] = "God",
    ["Trenozosturzzo Turbo 3000"] = "God",
    ["Bulbito Bandito Traktorito"] = "God",
    ["Urubini Flamenguini"] = "God",
    ["Jacko Jack Jack"] = "God",
    ["Trippi Troppi Troppa Trippa"] = "God",
    ["Capi Taco"] = "God",
    ["Los Chihuaninis"] = "God",
    ["Gattito Tacoto"] = "God",
    ["Las Capuchinas"] = "God",
    ["Ballerino Lololo"] = "God",
    ["Los Tungtungtungcitos"] = "God",
    ["Pakrahmatmamat"] = "God",
    ["Ballerina Peppermintina"] = "God",
    ["Piccione Macchina"] = "God",
    ["Pakrahmatmatina"] = "God",
    ["Los Bombinitos"] = "God",
    ["Tractoro Dinosauro"] = "God",
    ["Brr Es Teh Patipum"] = "God",
    ["Cacasito Satalito"] = "God",
    ["Orcalita Orcala"] = "God",
    ["Aquanaut"] = "God",
    ["Tartaruga Cisterna"] = "God",
    ["Snailenzo"] = "God",
    ["Corn Corn Corn Sahur"] = "God",
    ["Squalanana"] = "God",
    ["Mummy Ambalabu"] = "God",
    ["Los Orcalitos"] = "God",
    ["Dug Dug Dug"] = "God",
    ["Ginger Globo"] = "God",
    ["Yeti Claus"] = "God",
    ["Crabbo Limonetta"] = "God",
    ["Los Tipi Tacos"] = "God",
    ["Tootini Shrimpini"] = "God",
    ["Granchiello Spiritell"] = "God",
    ["Frio Ninja"] = "God",
    ["Piccionetta Macchina"] = "God",
    ["Boba Panda"] = "God",
    ["Mastodontico Telepiedone"] = "God",
    ["Los Gattitos"] = "God",
    ["Bambu Bambu Sahur"] = "God",
    ["Chrismasmamat"] = "God",
    ["Anpali Babel"] = "God",
    ["Cappuccino Clownino"] = "God",
    ["Luv Luv Luv"] = "God",
    ["Bombardini Tortinii"] = "God",
    ["Brasilini Berimbini"] = "God",
    ["Belula Beluga"] = "God",
    ["Krupuk Pagi Pagi"] = "God",
    ["Skull Skull Skull"] = "God",
    ["Cocoa Assassino"] = "God",
    ["Tentacolo Tecnico"] = "God",
    ["Ginger Cisterna"] = "God",
    ["Dolphini Jetskini"] = "God",
    ["Pop Pop Sahur"] = "God",
    ["Noo La Polizia"] = "God",
    ["Karkerheart Luvkur"] = "God",

    --SECRET
    ["La Taco Combinasion"] = "Secret",
    ["La Vacca Saturno Saturnita"] = "Secret",
    ["Pandanini Frostini"] = "Secret",
    ["Bisonte Giuppitere"] = "Secret",
    ["Blackhole Goat"] = "Secret",
    ["Jackorilla"] = "Secret",
    ["Agarrini Ia Palini"] = "Secret",
    ["Chachechi"] = "Secret",
    ["Karkerkar Kurkur"] = "Secret",
    ["Los Tortus"] = "Secret",
    ["Los Matteos"] = "Secret",
    ["Sammyni Spyderini"] = "Secret",
    ["Trenostruzzo Turbo 4000"] = "Secret",
    ["Chimpanzini Spiderini"] = "Secret",
    ["Boatito Auratito"] = "Secret",
    ["Fragola La La La"] = "Secret",
    ["Dul Dul Dul"] = "Secret",
    ["La Vacca Prese Presente"] = "Secret",
    ["Frankentteo"] = "Secret",
    ["Los Trios"] = "Secret",
    ["Karker Sahur"] = "Secret",
    ["Torrtuginni Dragonfrutini"] = "Secret",
    ["Los Tralaleritos"] = "Secret",
    ["Zombie Tralala"] = "Secret",
    ["La Cucaracha"] = "Secret",
    ["Vulturino Skeletono"] = "Secret",
    ["Guerriro Digitale"] = "Secret",
    ["Extinct Tralalero"] = "Secret",
    ["Yess My Examine"] = "Secret",
    ["Extinct Matteo"] = "Secret",
    ["Las Tralaleritas"] = "Secret",
    ["Rocco Disco"] = "Secret",
    ["Reindeer Tralala"] = "Secret",
    ["Las Vaquitas Saturnitas"] = "Secret",
    ["Pumpkin Spyderini"] = "Secret",
    ["Job Job Job Sahur"] = "Secret",
    ["Los Karkeritos"] = "Secret",
    ["Graipuss Medussi"] = "Secret",
    ["Santteo"] = "Secret",
    ["La Vacca Jacko Linterino"] = "Secret",
    ["Triplito Tralaleritos"] = "Secret",
    ["Trickolino"] = "Secret",
    ["Giftini Spyderini"] = "Secret",
    ["Los Spyderinis"] = "Secret",
    ["Love Love Love Sahur"] = "Secret",
    ["Perrito Burrito"] = "Secret",
    ["1x1x1x1"] = "Secret",
    ["Los Cucarachas"] = "Secret",
    ["Please My Present"] = "Secret",
    ["Cuadramat and Pakrahmatmamat"] = "Secret",
    ["Los Jobcitos"] = "Secret",
    ["Nooo My Hotspot"] = "Secret",
    ["Pot Hotspot"] = "Secret",
    ["Noo My Examine"] = "Secret",
    ["Telemorte"] = "Secret",
    ["La Sahur Combinasion"] = "Secret",
    ["List List List Sahur"] = "Secret",
    ["To To To Sahur"] = "Secret",
    ["Pirulitoita Bicicletaire"] = "Secret",
    ["25"] = "Secret",
    ["Santa Hotspot"] = "Secret",
    ["Horegini Boom"] = "Secret",
    ["Quesadilla Crocodila"] = "Secret",
    ["Pot Pumpkin"] = "Secret",
    ["Naughty Naughty"] = "Secret",
    ["Cupid Cupid Sahur"] = "Secret",
    ["Ho Ho Ho Sahur"] = "Secret",
    ["Mi Gatito"] = "Secret",
    ["Chicleteira Bicicleteira"] = "Secret",
    ["Cupid Hotspot"] = "Secret",
    ["Spaghetti Tualetti"] = "Secret",
    ["Esok Sekolah"] = "Secret",
    ["Quesadillo Vampiro"] = "Secret",
    ["Brunito Marsito"] = "Secret",
    ["Chill Puppy"] = "Secret",
    ["Burrito Bandito"] = "Secret",
    ["Chicleteirina Bicicleteirina"] = "Secret",
    ["Los Quesadillas"] = "Secret",
    ["Bunito Bunito Spinito"] = "Secret",
    ["Noo My Candy"] = "Secret",
    ["Los Nooo My Hotspotsitos"] = "Secret",
    ["La Grande Combinasion"] = "Secret",
    ["Rang Ring Bus"] = "Secret",
    ["Guest 666"] = "Secret",
    ["Los Mi Gatitos"] = "Secret",
    ["Los Chicleteiras"] = "Secret",
    ["67"] = "Secret",
    ["Donkeyturbo Express"] = "Secret",
    ["Mariachi Corazoni"] = "Secret",
    ["Los Burritos"] = "Secret",
    ["Los 25"] = "Secret",
    ["Swag Soda"] = "Secret",
    ["Noo my Heart"] = "Secret",
    ["Chimnino"] = "Secret",
    ["Los Combinasionas"] = "Secret",
    ["Chicleteira Noelteira"] = "Secret",
    ["Fishino Clownino"] = "Secret",
    ["Tacorita Bicicleta"] = "Secret",
    ["Spinny Hammy"] = "Secret",
    ["Nuclearo Dinosauro"] = "Secret",
    ["Las Sis"] = "Secret",
    ["Chicleteira Cupideira"] = "Secret",
    ["La Karkerkar Combinasion"] = "Secret",
    ["Chillin Chili"] = "Secret",
    ["Chipso and Queso"] = "Secret",
    ["Money Money Reindeer"] = "Secret",
    ["Money Money Puggy"] = "Secret",
    ["Celularcini Viciosini"] = "Secret",
    ["Los Planitos"] = "Secret",
    ["Los Mobilis"] = "Secret",
    ["Los 67"] = "Secret",
    ["Mieteteira Bicicleteira"] = "Secret",
    ["Tuff Toucan"] = "Secret",
    ["La Spooky Grande"] = "Secret",
    ["Los Spooky Combinasionas"] = "Secret",
    ["Los Candies"] = "Secret",
    ["Los Hotspositos"] = "Secret",
    ["Los Jolly Combinasionas"] = "Secret",
    ["Los Puggies"] = "Secret",
    ["W or L"] = "Secret",
    ["Tralalalaledon"] = "Secret",
    ["La Extinct Grande"] = "Secret",
    ["Tralaledon"] = "Secret",
    ["La Jolly Grande"] = "Secret",
    ["Los Primos"] = "Secret",
    ["Bacuru and Egguru"] = "Secret",
    ["Eviledon"] = "Secret",
    ["Los Tacoritas"] = "Secret",
    ["Lovin Rose"] = "Secret",
    ["Tang Tang Kelentang"] = "Secret",
    ["Ketupat Kepat"] = "Secret",
    ["Los Bros"] = "Secret",
    ["Tictac Sahur"] = "Secret",
    ["La Romantic Grande"] = "Secret",
    ["Gingerat Gerat"] = "Secret",
    ["Orcaledon"] = "Secret",
    ["Ketchuru and Masturu"] = "Secret",
    ["Jolly Jolly Sahur"] = "Secret",
    ["Garama and Madundung"] = "Secret",
    ["Rosetti Tualetti"] = "Secret",
    ["Festive 67"] = "Secret",
    ["Love Love Bear"] = "Secret",
    ["La Ginger Sekolah"] = "Secret",
    ["Spooky and Pumpky"] = "Secret",
    ["Lavadorito Spinito"] = "Secret",
    ["Los Spaghettis"] = "Secret",
    ["La Casa Boo"] = "Secret",
    ["Fragrama and Chocrama"] = "Secret",
    ["La Secret Combinasion"] = "Secret",
    ["Reinito Sleighito"] = "Secret",
    ["Ketupat Bros"] = "Secret",
    ["Burguro And Fryuro"] = "Secret",
    ["Cooki and Milki"] = "Secret",
    ["Capitano Moby"] = "Secret",
    ["Rosey and Teddy"] = "Secret",
    ["Popcuru and Fizzuru"] = "Secret",
    ["Cerberus"] = "Secret",
    ["La Supreme Combinasion"] = "Secret",
    ["Dragon Cannelloni"] = "Secret",
    ["Dragon Gingerini"] = "Secret",
    ["Headless Horseman"] = "Secret",
    ["Hydra Dragon Cannelloni"] = "Secret",

    ["Skibidi Toilet"] = "OG",
    ["Meowl"] = "OG",
    ["Strawberry Elephant"] = "OG"

}
local costByName = {

    ["Swaggy Bros"] = 7000000000,
    ["Los Amigos"] = 55000000000,
    ["Sammyni Fattini"] = 20000000000,
    ["La Food Combinasion"] = 30000000,
    ["Los Sekolahs"] = 45000000000,
    --og
    ["Smurf Cat"] = 999999999999,
    ["John Pork"] = 999999999999,

    
    --GOD
    ["Tim Cheese"] = 500,
    ["Fizzy Soda"] = 4900000,
    ["Cocofanto Elefanto"] = 5000000,
    ["Antonio"] = 6000000,
    ["Girafa Celestre"] = 7500000,
    ["Gattatino Nyanino"] = 7500000,
    ["Gattatino Neonino"] = 7500000,
    ["Chihuanini Taconini"] = 8500000,
    ["Matteo"] = 10000000,
    ["Tralalero Tralala"] = 10000000,
    ["Los Crocodillitos"] = 12500000,
    ["Tigroligre Frutonni"] = 15000000,
    ["Boatito Auratito"] = 525000,
    ["Odin Din Din Dun"] = 15000000,
    ["Orcalero Orcala"] = 15000000,
    ["Money Money Man"] = 17500000,
    ["Alessio"] = 17500000,
    ["Unclito Samito"] = 20000000,
    ["Statutino Libertino"] = 20000000,
    ["Tipi Topi Taco"] = 20000000,
    ["Tralalita Tralala"] = 20000000,
    ["Tukanno Banana"] = 22500000,
    ["Extinct Ballerina"] = 23500000,
    ["Vampira Cappucina"] = 24500000,
    ["Espresso Signora"] = 25000000,
    ["Trenozosturzzo Turbo 3000"] = 25000000,
    ["Bulbito Bandito Traktorito"] = 25000000,
    ["Urubini Flamenguini"] = 30000000,
    ["Jacko Jack Jack"] = 30000000,
    ["Trippi Troppi Troppa Trippa"] = 30000000,
    ["Capi Taco"] = 31000000,
    ["Los Chihuaninis"] = 32000000,
    ["Gattito Tacoto"] = 32500000,
    ["Las Capuchinas"] = 32500000,
    ["Ballerino Lololo"] = 35000000,
    ["Los Tungtungtungcitos"] = 37500000,
    ["Pakrahmatmamat"] = 37500000,
    ["Ballerina Peppermintina"] = 37500000,
    ["Piccione Macchina"] = 40000000,
    ["Pakrahmatmatina"] = 40500000,
    ["Los Bombinitos"] = 42500000,
    ["Tractoro Dinosauro"] = 42500000,
    ["Brr Es Teh Patipum"] = 45000000,
    ["Cacasito Satalito"] = 45000000,
    ["Orcalita Orcala"] = 45000000,
    ["Aquanaut"] = 45500000,
    ["Tartaruga Cisterna"] = 45000000,
    ["Snailenzo"] = 45000000,
    ["Corn Corn Corn Sahur"] = 45000000,
    ["Squalanana"] = 45000000,
    ["Mummy Ambalabu"] = 45000000,
    ["Los Orcalitos"] = 45000000,
    ["Dug Dug Dug"] = 45500000,
    ["Ginger Globo"] = 45700000,
    ["Yeti Claus"] = 45700000,
    ["Crabbo Limonetta"] = 46000000,
    ["Los Tipi Tacos"] = 46000000,
    ["Tootini Shrimpini"] = 46000000,
    ["Granchiello Spiritell"] = 46000000,
    ["Frio Ninja"] = 46500000,
    ["Piccionetta Macchina"] = 47000000,
    ["Boba Panda"] = 47000000,
    ["Mastodontico Telepiedone"] = 47500000,
    ["Los Gattitos"] = 47500000,
    ["Bambu Bambu Sahur"] = 47500000,
    ["Chrismasmamat"] = 47700000,
    ["Anpali Babel"] = 48000000,
    ["Cappuccino Clownino"] = 48000000,
    ["Luv Luv Luv"] = 48300000,
    ["Bombardini Tortinii"] = 50000000,
    ["Brasilini Berimbini"] = 55500000,
    ["Belula Beluga"] = 60000000,
    ["Krupuk Pagi Pagi"] = 60000000,
    ["Skull Skull Skull"] = 60000000,
    ["Cocoa Assassino"] = 60000000,
    ["Tentacolo Tecnico"] = 62500000,
    ["Ginger Cisterna"] = 63500000,
    ["Dolphini Jetskini"] = 64500000,
    ["Pop Pop Sahur"] = 65000000,
    ["Noo La Polizia"] = 67000000,
    ["Karkerheart Luvkur"] = 67500000,

    --SECRET

    ["La Taco Combinasion"] = 5000000000,
    ["La Vacca Saturno Saturnita"] = 50000000,
    ["Pandanini Frostini"] = 64000000,
    ["Bisonte Giuppitere"] = 75000000,
    ["Blackhole Goat"] = 75000000,
    ["Jackorilla"] = 80000000,
    ["Agarrini Ia Palini"] = 80000000,
    ["Chachechi"] = 85000000,

    ["Karkerkar Kurkur"] = 100000000,
    ["Los Tortus"] = 100000000,
    ["Los Matteos"] = 100000000,
    ["Sammyni Spyderini"] = 100000000,
    ["Trenostruzzo Turbo 4000"] = 100000000,
    ["Chimpanzini Spiderini"] = 100000000,
    ["Los Tralaleritos"] = 100000000,
    ["Zombie Tralala"] = 100000000,

    ["La Cucaracha"] = 110000000,
    ["Vulturino Skeletono"] = 110000000,

    ["Guerriro Digitale"] = 120000000,

    ["Fragola La La La"] = 125000000,
    ["Extinct Tralalero"] = 125000000,

    ["Yess My Examine"] = 130000000,

    ["Extinct Matteo"] = 140000000,

    ["Dul Dul Dul"] = 150000000,
    ["Las Tralaleritas"] = 150000000,
    ["Rocco Disco"] = 150000000,

    ["La Vacca Prese Presente"] = 160000000,
    ["Reindeer Tralala"] = 160000000,
    ["Las Vaquitas Saturnitas"] = 160000000,

    ["Pumpkin Spyderini"] = 165000000,

    ["Frankentteo"] = 175000000,
    ["Los Trios"] = 175000000,
    ["Job Job Job Sahur"] = 175000000,

    ["Karker Sahur"] = 185000000,

    ["Los Karkeritos"] = 200000000,
    ["Graipuss Medussi"] = 200000000,

    ["Santteo"] = 210000000,

    ["La Vacca Jacko Linterino"] = 225000000,

    ["Triplito Tralaleritos"] = 230000000,

    ["Trickolino"] = 235000000,

    ["Giftini Spyderini"] = 240000000,

    ["Los Spyderinis"] = 250000000,
    ["Love Love Love Sahur"] = 250000000,
    ["Perrito Burrito"] = 250000000,

    ["1x1x1x1"] = 255500000,

    ["Los Cucarachas"] = 300000000,
    ["Please My Present"] = 350000000,
    ["Cuadramat and Pakrahmatmamat"] = 400000000,

    ["Los Jobcitos"] = 500000000,
    ["Torrtuginni Dragonfrutini"] = 500000000,
    ["Nooo My Hotspot"] = 500000000,
    ["Pot Hotspot"] = 500000000,

    ["Noo My Examine"] = 525000000,

    ["Telemorte"] = 550000000,
    ["La Sahur Combinasion"] = 550000000,
    ["List List List Sahur"] = 550000000,

    ["To To To Sahur"] = 575000000,

    ["Pirulitoita Bicicletaire"] = 600000000,
    ["25"] = 600000000,

    ["Santa Hotspot"] = 625000000,

    ["Horegini Boom"] = 650000000,

    ["Quesadilla Crocodila"] = 700000000,
    ["Pot Pumpkin"] = 700000000,
    ["Naughty Naughty"] = 700000000,

    ["Cupid Cupid Sahur"] = 715000000,

    ["Ho Ho Ho Sahur"] = 725000000,
    ["Mi Gatito"] = 725000000,

    ["Chicleteira Bicicleteira"] = 750000000,
    ["Cupid Hotspot"] = 750000000,
    ["Spaghetti Tualetti"] = 750000000,
    ["Esok Sekolah"] = 750000000,
    ["Quesadillo Vampiro"] = 750000000,
    ["Brunito Marsito"] = 750000000,

    ["Chill Puppy"] = 800000000,
    ["Burrito Bandito"] = 800000000,

    ["Chicleteirina Bicicleteirina"] = 850000000,

    ["Los Quesadillas"] = 875000000,

    ["Bunito Bunito Spinito"] = 900000000,
    ["Noo My Candy"] = 900000000,

    ["Los Nooo My Hotspotsitos"] = 1000000000,
    ["La Grande Combinasion"] = 1000000000,

    ["Rang Ring Bus"] = 1100000000,
    ["Guest 666"] = 1100000000,

    ["Los Mi Gatitos"] = 1200000000,
    ["Los Chicleteiras"] = 1200000000,
    ["67"] = 1200000000,
    ["Donkeyturbo Express"] = 1200000000,
    ["Mariachi Corazoni"] = 1200000000,

    ["Los Burritos"] = 1400000000,
    ["Los 25"] = 1500000000,

    ["Swag Soda"] = 1800000000,
    ["Noo my Heart"] = 1800000000,

    ["Chimnino"] = 1900000000,

    ["Los Combinasionas"] = 2000000000,
    ["Chicleteira Noelteira"] = 2000000000,

    ["Fishino Clownino"] = 2100000000,

    ["Tacorita Bicicleta"] = 2200000000,

    ["Spinny Hammy"] = 2300000000,

    ["Nuclearo Dinosauro"] = 2500000000,
    ["Las Sis"] = 2500000000,
    ["Chicleteira Cupideira"] = 2500000000,
    ["La Karkerkar Combinasion"] = 2500000000,
    ["Chillin Chili"] = 2500000000,
    ["Chipso and Queso"] = 2500000000,
    ["Money Money Reindeer"] = 2500000000,

    ["Money Money Puggy"] = 2600000000,
    ["Celularcini Viciosini"] = 2600000000,

    ["Los Planitos"] = 2700000000,
    ["Los Mobilis"] = 2700000000,
    ["Los 67"] = 2700000000,
    ["Mieteteira Bicicleteira"] = 2700000000,
    ["Tuff Toucan"] = 2700000000,

    ["La Spooky Grande"] = 2900000000,

    ["Los Spooky Combinasionas"] = 3000000000,
    ["Los Candies"] = 3000000000,
    ["Los Hotspositos"] = 3000000000,
    ["Los Jolly Combinasionas"] = 3000000000,
    ["Los Puggies"] = 3000000000,
    ["W or L"] = 3000000000,
    ["Tralalalaledon"] = 3000000000,

    ["La Extinct Grande"] = 3200000000,

    ["Tralaledon"] = 3500000000,
    ["La Jolly Grande"] = 3500000000,

    ["Los Primos"] = 3700000000,

    ["Bacuru and Egguru"] = 3800000000,
    ["Eviledon"] = 3800000000,

    ["Los Tacoritas"] = 4000000000,

    ["Lovin Rose"] = 4200000000,

    ["Tang Tang Kelentang"] = 4500000000,

    ["Ketupat Kepat"] = 5000000000,

    ["Los Bros"] = 6000000000,
    ["Tictac Sahur"] = 6000000000,

    ["La Romantic Grande"] = 7000000000,
    ["Gingerat Gerat"] = 7000000000,
    ["Orcaledon"] = 7000000000,

    ["Ketchuru and Masturu"] = 7500000000,

    ["Jolly Jolly Sahur"] = 8000000000,

    ["Garama and Madundung"] = 10000000000,
    ["Rosetti Tualetti"] = 10000000000,

    ["Festive 67"] = 16000000000,

    ["Love Love Bear"] = 23000000000,
    ["La Ginger Sekolah"] = 23000000000,

    ["Spooky and Pumpky"] = 25000000000,

    ["Lavadorito Spinito"] = 30000000000,

    ["Los Spaghettis"] = 40000000000,
    ["La Casa Boo"] = 40000000000,
    ["Fragrama and Chocrama"] = 40000000000,

    ["La Secret Combinasion"] = 50000000000,

    ["Reinito Sleighito"] = 60000000000,

    ["Ketupat Bros"] = 65000000000,

    ["Burguro And Fryuro"] = 75000000000,

    ["Cooki and Milki"] = 100000000000,

    ["Capitano Moby"] = 125000000000,
    ["Rosey and Teddy"] = 130000000000,
    ["Popcuru and Fizzuru"] = 135000000000,

    ["Cerberus"] = 150000000000,

    ["La Supreme Combinasion"] = 200000000000,

    ["Dragon Cannelloni"] = 250000000000,
    ["Dragon Gingerini"] = 300000000000,
    ["Headless Horseman"] = 325000000000,
    ["Hydra Dragon Cannelloni"] = 350000000000,

    ["Skibidi Toilet"] = 400000000000,
    ["Meowl"] = 500000000000,
    ["Strawberry Elephant"] = 750000000000
}
local incomeByName = {
    ["Swaggy Bros"] = 40000000,
    ["Los Amigos"] = 130000000,
    ["Sammyni Fattini"] = 70000000,
    ["John Pork"] = 999999999999999,
    ["Smurf Cat"] = 999999999999999,

    ["La Food Combinasion"] = 90000000,
    ["Los Sekolahs"] = 110000000,
    --GOD
    ["Tim Cheese"] = 20,
    ["Fizzy Soda"] = 17200,
    ["Cocofanto Elefanto"] = 10000,
    ["Antonio"] = 18500,
    ["Girafa Celestre"] = 20000,
    ["Gattatino Nyanino"] = 35000,
    ["Gattatino Neonino"] = 20000,
    ["Chihuanini Taconini"] = 45000,
    ["Matteo"] = 50000,
    ["Tralalero Tralala"] = 50000,
    ["Los Crocodillitos"] = 55000,
    ["Tigroligre Frutonni"] = 60000,
    ["Odin Din Din Dun"] = 75000,
    ["Orcalero Orcala"] = 100000,
    ["Money Money Man"] = 65000,
    ["Alessio"] = 65000,
    ["Unclito Samito"] = 65000,
    ["Statutino Libertino"] = 75000,
    ["Tipi Topi Taco"] = 75000,
    ["Tralalita Tralala"] = 100000,
    ["Tukanno Banana"] = 100000,
    ["Extinct Ballerina"] = 125000,
    ["Vampira Cappucina"] = 125000,
    ["Espresso Signora"] = 70000,
    ["Trenozosturzzo Turbo 3000"] = 150000,
    ["Bulbito Bandito Traktorito"] = 205000,
    ["Urubini Flamenguini"] = 150000,
    ["Jacko Jack Jack"] = 150000,
    ["Trippi Troppi Troppa Trippa"] = 175000,
    ["Capi Taco"] = 155000,
    ["Los Chihuaninis"] = 160000,
    ["Gattito Tacoto"] = 165000,
    ["Las Capuchinas"] = 185000,
    ["Ballerino Lololo"] = 200000,
    ["Los Tungtungtungcitos"] = 210000,
    ["Pakrahmatmamat"] = 215000,
    ["Ballerina Peppermintina"] = 215000,
    ["Piccione Macchina"] = 225000,
    ["Pakrahmatmatina"] = 225000,
    ["Los Bombinitos"] = 220000,
    ["Tractoro Dinosauro"] = 230000,
    ["Brr Es Teh Patipum"] = 225000,
    ["Cacasito Satalito"] = 240000,
    ["Orcalita Orcala"] = 240000,
    ["Aquanaut"] = 245000,
    ["Tartaruga Cisterna"] = 250000,
    ["Snailenzo"] = 250000,
    ["Corn Corn Corn Sahur"] = 250000,
    ["Squalanana"] = 250000,
    ["Mummy Ambalabu"] = 250000,
    ["Los Orcalitos"] = 310000,
    ["Dug Dug Dug"] = 255000,
    ["Ginger Globo"] = 257500,
    ["Yeti Claus"] = 267500,
    ["Crabbo Limonetta"] = 230000,
    ["Los Tipi Tacos"] = 260000,
    ["Tootini Shrimpini"] = 260000,
    ["Granchiello Spiritell"] = 260000,
    ["Frio Ninja"] = 265000,
    ["Piccionetta Macchina"] = 270000,
    ["Boba Panda"] = 270000,
    ["Mastodontico Telepiedone"] = 275000,
    ["Los Gattitos"] = 275000,
    ["Bambu Bambu Sahur"] = 275000,
    ["Chrismasmamat"] = 277500,
    ["Anpali Babel"] = 280000,
    ["Cappuccino Clownino"] = 285000,
    ["Luv Luv Luv"] = 282000,
    ["Bombardini Tortinii"] = 225000,
    ["Brasilini Berimbini"] = 285000,
    ["Belula Beluga"] = 290000,
    ["Krupuk Pagi Pagi"] = 290000,
    ["Skull Skull Skull"] = 290000,
    ["Cocoa Assassino"] = 291000,
    ["Tentacolo Tecnico"] = 295000,
    ["Ginger Cisterna"] = 293500,
    ["Dolphini Jetskini"] = 294500,
    ["Pop Pop Sahur"] = 295000,
    ["Noo La Polizia"] = 280000,
    ["Karkerheart Luvkur"] = 297500,

    --SECRET
    ["La Taco Combinasion"] = 35000000,
    ["La Vacca Saturno Saturnita"] = 300000,
    ["Pandanini Frostini"] = 294000,
    ["Bisonte Giuppitere"] = 300000,
    ["Blackhole Goat"] = 400000,
    ["Jackorilla"] = 315000,
    ["Agarrini Ia Palini"] = 425000,
    ["Chachechi"] = 400000,
    ["Karkerkar Kurkur"] = 275000,
    ["Los Tortus"] = 500000,
    ["Los Matteos"] = 300000,
    ["Sammyni Spyderini"] = 300000,
    ["Trenostruzzo Turbo 4000"] = 310000,
    ["Chimpanzini Spiderini"] = 325000,
    ["Boatito Auratito"] = 525000,
    ["Fragola La La La"] = 450000,
    ["Dul Dul Dul"] = 375000,
    ["La Vacca Prese Presente"] = 600000,
    ["Frankentteo"] = 700000,
    ["Los Trios"] = 700000,
    ["Karker Sahur"] = 725000,
    ["Torrtuginni Dragonfrutini"] = 350000,
    ["Los Tralaleritos"] = 500000,
    ["Zombie Tralala"] = 500000,
    ["La Cucaracha"] = 475000,
    ["Vulturino Skeletono"] = 500000,
    ["Guerriro Digitale"] = 550000,
    ["Extinct Tralalero"] = 450000,
    ["Yess My Examine"] = 575000,
    ["Extinct Matteo"] = 625000,
    ["Las Tralaleritas"] = 650000,
    ["Rocco Disco"] = 650000,
    ["Reindeer Tralala"] = 600000,
    ["Las Vaquitas Saturnitas"] = 750000,
    ["Pumpkin Spyderini"] = 650000,
    ["Job Job Job Sahur"] = 700000,
    ["Los Karkeritos"] = 750000,
    ["Graipuss Medussi"] = 1000000,
    ["Santteo"] = 800000,
    ["La Vacca Jacko Linterino"] = 850000,
    ["Triplito Tralaleritos"] = 875000,
    ["Trickolino"] = 900000,
    ["Giftini Spyderini"] = 999900,
    ["Los Spyderinis"] = 450000,
    ["Love Love Love Sahur"] = 1000000,
    ["Perrito Burrito"] = 1000000,
    ["1x1x1x1"] = 1100000,
    ["Los Cucarachas"] = 1200000,
    ["Please My Present"] = 1300000,
    ["Cuadramat and Pakrahmatmamat"] = 1400000,
    ["Los Jobcitos"] = 1500000,
    ["Nooo My Hotspot"] = 2000000,
    ["Pot Hotspot"] = 2500000,
    ["Noo My Examine"] = 1700000,
    ["Telemorte"] = 2000000,
    ["La Sahur Combinasion"] = 2000000,
    ["List List List Sahur"] = 2000000,
    ["To To To Sahur"] = 2250000,
    ["Pirulitoita Bicicletaire"] = 2500000,
    ["25"] = 2500000,
    ["Santa Hotspot"] = 2600000,
    ["Horegini Boom"] = 2700000,
    ["Quesadilla Crocodila"] = 3000000,
    ["Pot Pumpkin"] = 3000000,
    ["Naughty Naughty"] = 3000000,
    ["Cupid Cupid Sahur"] = 3100000,
    ["Ho Ho Ho Sahur"] = 3200000,
    ["Mi Gatito"] = 3200000,
    ["Chicleteira Bicicleteira"] = 3500000,
    ["Cupid Hotspot"] = 3500000,
    ["Spaghetti Tualetti"] = 60000000,
    ["Esok Sekolah"] = 30000000,
    ["Quesadillo Vampiro"] = 3500000,
    ["Brunito Marsito"] = 3500000,
    ["Chill Puppy"] = 4000000,
    ["Burrito Bandito"] = 4000000,
    ["Chicleteirina Bicicleteirina"] = 4000000,
    ["Los Quesadillas"] = 4500000,
    ["Bunito Bunito Spinito"] = 3000000,
    ["Noo My Candy"] = 5000000,
    ["Los Nooo My Hotspotsitos"] = 5000000,
    ["La Grande Combinasion"] = 10000000,
    ["Rang Ring Bus"] = 6000000,
    ["Guest 666"] = 6600000,
    ["Los Mi Gatitos"] = 6500000,
    ["Los Chicleteiras"] = 7000000,
    ["67"] = 7500000,
    ["Donkeyturbo Express"] = 7500000,
    ["Mariachi Corazoni"] = 12500000,
    ["Los Burritos"] = 8500000,
    ["Los 25"] = 10000000,
    ["Swag Soda"] = 13000000,
    ["Noo my Heart"] = 13000000,
    ["Chimnino"] = 14000000,
    ["Los Combinasionas"] = 15000000,
    ["Chicleteira Noelteira"] = 15000000,
    ["Fishino Clownino"] = 15500000,
    ["Tacorita Bicicleta"] = 16500000,
    ["Spinny Hammy"] = 17000000,
    ["Nuclearo Dinosauro"] = 15000000,
    ["Las Sis"] = 17500000,
    ["Chicleteira Cupideira"] = 17500000,
    ["La Karkerkar Combinasion"] = 17500000,
    ["Chillin Chili"] = 25000000,
    ["Chipso and Queso"] = 25000000,
    ["Money Money Reindeer"] = 25000000,
    ["Money Money Puggy"] = 21000000,
    ["Celularcini Viciosini"] = 22500000,
    ["Los Planitos"] = 18500000,
    ["Los Mobilis"] = 22000000,
    ["Los 67"] = 22500000,
    ["Mieteteira Bicicleteira"] = 26000000,
    ["Tuff Toucan"] = 26000000,
    ["La Spooky Grande"] = 24500000,
    ["Los Spooky Combinasionas"] = 20000000,
    ["Los Candies"] = 23000000,
    ["Los Hotspositos"] = 25000000,
    ["Los Jolly Combinasionas"] = 25000000,
    ["Los Puggies"] = 30000000,
    ["W or L"] = 30000000,
    ["Tralalalaledon"] = 37500000,
    ["La Extinct Grande"] = 23500000,
    ["Tralaledon"] = 27500000,
    ["La Jolly Grande"] = 30000000,
    ["Los Primos"] = 31000000,
    ["Bacuru and Egguru"] = 24000000,
    ["Eviledon"] = 31500000,
    ["Los Tacoritas"] = 32000000,
    ["Lovin Rose"] = 32500000,
    ["Tang Tang Kelentang"] = 33500000,
    ["Ketupat Kepat"] = 35000000,
    ["Los Bros"] = 37500000,
    ["Tictac Sahur"] = 37500000,
    ["La Romantic Grande"] = 40000000,
    ["Gingerat Gerat"] = 40000000,
    ["Orcaledon"] = 40000000,
    ["Ketchuru and Masturu"] = 42500000,
    ["Jolly Jolly Sahur"] = 45000000,
    ["Garama and Madundung"] = 50000000,
    ["Rosetti Tualetti"] = 50000000,
    ["Festive 67"] = 67000000,
    ["Love Love Bear"] = 140000000,
    ["La Ginger Sekolah"] = 75000000,
    ["Spooky and Pumpky"] = 80000000,
    ["Lavadorito Spinito"] = 45000000,
    ["Los Spaghettis"] = 70000000,
    ["La Casa Boo"] = 100000000,
    ["Fragrama and Chocrama"] = 100000000,
    ["La Secret Combinasion"] = 125000000,
    ["Reinito Sleighito"] = 140000000,
    ["Ketupat Bros"] = 145000000,
    ["Burguro And Fryuro"] = 150000000,
    ["Cooki and Milki"] = 155000000,
    ["Capitano Moby"] = 160000000,
    ["Rosey and Teddy"] = 165000000,
    ["Popcuru and Fizzuru"] = 170000000,
    ["Cerberus"] = 175000000,
    ["La Supreme Combinasion"] = 200000000,
    ["Dragon Cannelloni"] = 250000000,
    ["Dragon Gingerini"] = 300000000,
    ["Headless Horseman"] = 325000000,
    ["Hydra Dragon Cannelloni"] = 350000000,
    ["Skibidi Toilet"] = 400000000,
    ["Meowl"] = 500000000,
    ["Strawberry Elephant"] = 750000000

}
local mutationMultipliers = {
    ["None"] = 1,
    ["Gold"] = 1.25,
    ["Diamond"] = 1.5,
    ["Bloodrot"] = 2,
    ["Candy"] = 4,
    ["Lava"] = 6,
    ["Galaxy"] = 7,
    ["YinYang"] = 7.5,
    ["Radioactive"] = 8.5,
    ["Cursed"] = 9,
    ["Divine"] = 10,
    ["Rainbow"] = 10
}

local traits = {
    -- OG Event Traits
    ["Strawberry"] = 8,
    ["Meowl"] = 7,
    ["Skibidi"] = 6.5,
    [":3"] = 5.5,

    -- Seasonal Event Traits
    ["Reindeer"] = 6,
    ["Santa Hat"] = 5,
    ["Jack O' Lantern"] = 5.5,
    ["RIP Tombstone"] = 4.5,
    ["Witching Hour"] = 4.5,
    ["Extinct"] = 4,
    ["10B"] = 4,
    ["2026"] = 6,

    -- Ritual Event Traits
    ["Paint"] = 6,
    ["Tie"] = 4.75,
    ["Spider"] = 4.5,
    ["Matteo Hat"] = 4.5,
    ["Galactic"] = 4,
    ["Explosive"] = 4,
    ["Shark Fin"] = 4,

    -- Country Event Traits
    ["Brazil"] = 6,
    ["Indonesian"] = 5,
    ["Sombrero"] = 5, -- Mexico Hat / Sombrero

    -- Admin-Only Event Traits
    ["Fire"] = 6,
    ["Rose"] = 6,
    ["Fireworks"] = 6,
    ["Nyan"] = 6,
    ["Lightning"] = 6,
    ["Disco"] = 5,
    ["Glitched"] = 5,
    ["CrabClaw"] = 5, -- Crab Claw
    ["Tung Tung Attack"] = 5, -- Zombie / EvilTungTungSahur
    ["Bubblegum"] = 4,
    ["UFO"] = 3,
    ["Taco"] = 3,
    ["Chocolate"] = 5.5,

    -- Natural Event Traits
    ["Comet-struck"] = 3.5,
    ["Snowy"] = 3,
    ["Wet"] = 2.5,

    -- Worst Trait
    ["Sleepy"] = 0.5, -- Ã·2
}
local traitAliases = {
    -- Strawberry / Meowl / Skibidi
    ["ICON Meowl"] = "Meowl",
    ["SkibidiIcon"] = "Skibidi",
    ["Strawberry Strawberry"] = "Strawberry",
    [":3"] = ":3",
    [" :3"] = ":3",
    [":3 "] = ":3",

    -- Seasonal
    ["SantaHatIcon"] = "Santa Hat",
    ["SantaHat"] = "Santa Hat",
    ["Jack-o-Lantern Pet Trait"] = "Jack O' Lantern",
    ["JackOLanternPetTrait"] = "Jack O' Lantern",
    ["GraveYard-RIP-Tombstone"] = "RIP Tombstone",
    ["Witchhat"] = "Witching Hour",
    ["Extincty"] = "Extinct",
    ["ExtinctyExtinct"] = "Extinct",
    ["10b"] = "10B",
    ["10b10B"] = "10B",
    ["2026Trait"] = "2026",
    ["2026Trait26"] = "2026",

    -- Ritual
    ["Chicleteirabicicleteira"] = "Paint",
    ["ChicleteirabicicleteiraPaint"] = "Paint",
    ["MatteoHat"] = "Matteo Hat",
    ["Comet2"] = "Galactic",
    ["Comet2Galactic"] = "Galactic",
    ["Bombardiro"] = "Explosive",
    ["BombardiroExplosive"] = "Explosive",
    ["SpiderSpider"] = "Spider",
    ["TieTie"] = "Tie",

    -- Country
    ["Mexico Hat"] = "Sombrero",
    ["MexicoHatSombrero"] = "Sombrero",
    ["IndonesianIndonesian"] = "Indonesian",
    ["BrazilBrazil"] = "Brazil",

    -- Admin-only / other common in-game wording
    ["Dragon"] = "Lightning",
    ["Lightning Dragon"] = "Lightning",
    ["DragonLightning"] = "Lightning",
    ["Alienevent"] = "UFO",
    ["AlieneventUFO"] = "UFO",
    ["Glitch"] = "Glitched",
    ["GlitchGlitched"] = "Glitched",
    ["Crab Claw"] = "CrabClaw",
    ["Claw"] = "CrabClaw",
    ["Claws"] = "CrabClaw",
    ["CrabClawCrab"] = "CrabClaw",
    ["EvilTungTungSahur"] = "Tung Tung Attack",
    ["Zombie"] = "Tung Tung Attack",
    ["Reindeer Pet"] = "Reindeer",
    ["ReindeerReindeer"] = "Reindeer",
    ["TacoTaco"] = "Taco",
    ["BubblegumBubblegum"] = "Bubblegum",
    ["DiscoRapConcert"] = "Disco",
    ["FireworksFireworks"] = "Fireworks",
    ["NyanNyan"] = "Nyan",
    ["FireFire"] = "Fire",
    ["RoseLance"] = "Rose",
    ["ChocolateTrait"] = "Chocolate",
    
    -- Natural
    ["Cometstruck"] = "Comet-struck",
    ["CometstruckComet-struck"] = "Comet-struck",
    ["WetRain"] = "Wet",
    ["SnowySnowy"] = "Snowy",

    -- Worst
    ["SleepySleepy"] = "Sleepy",
}

--// HELPER FUNCTIONS
local function getRequest()
    return (syn and syn.request) or (http and http.request) or http_request or request
end

local function clampStr(s, maxLen)
    s = tostring(s or "")
    return #s > maxLen and s:sub(1, maxLen - 3) .. "..." or s
end

local function short(n)
    n = tonumber(n) or 0
    local abs = math.abs(n)
    local suffixes = {{1e12, "T"}, {1e9, "B"}, {1e6, "M"}, {1e3, "K"}}
    for _, s in ipairs(suffixes) do
        if abs >= s[1] then
            return string.format("%.2f", n / s[1]):gsub("%.00$", "") .. s[2]
        end
    end
    return tostring(n)
end

local function normalizeMutation(m)
    if not m or m == "" then return "None" end
    m = tostring(m):gsub("%s+", "")
    local map = {none="None", default="None", gold="Gold", diamond="Diamond", bloodrot="Bloodrot", candy="Candy", lava="Lava", galaxy="Galaxy", yinyang="YinYang", radioactive="Radioactive", cursed="Cursed", divine="Divine", rainbow="Rainbow"}
    return map[m:lower()] or m
end

local function normalizeBrainrotName(raw)
    raw = tostring(raw or ""):gsub("%b[]", ""):gsub("%b()", ""):gsub("^%s+", ""):gsub("%s+$", "")
    return raw
end

local function normalizeKey(raw)
    return normalizeBrainrotName(raw):lower()
end

local function parseTraits(traitString)
    if not traitString then return {} end
    local result, seen = {}, {}
    for part in string.gmatch(tostring(traitString), "[^,]+") do
        local clean = part:gsub("%s*[xX]%d+", ""):gsub("^%s+", ""):gsub("%s+$", "")
        if clean ~= "" and not seen[clean] then
            seen[clean] = true
            table.insert(result, clean)
        end
    end
    return result
end

-- Combined function to get both mutation and trait in one pass (avoids duplicate GetDescendants)
local function getMutationAndTrait(obj)
    if not obj then return nil, nil end
    
    -- Check attributes first (fastest)
    local mutation = obj:GetAttribute("Mutation")
    local trait = obj:GetAttribute("Traits")
    if mutation and trait then
        return tostring(mutation), tostring(trait)
    end
    
    -- Check direct children
    if not mutation then
        local mutationChild = obj:FindFirstChild("Mutation")
        if mutationChild and mutationChild:IsA("ValueBase") then
            mutation = tostring(mutationChild.Value)
        end
    end
    if not trait then
        local traitChild = obj:FindFirstChild("Traits")
        if traitChild and traitChild:IsA("ValueBase") then
            trait = tostring(traitChild.Value)
        end
    end
    if mutation and trait then
        return mutation, trait
    end
    
    -- Single GetDescendants pass for both values (major performance gain)
    for _, d in ipairs(obj:GetDescendants()) do
        if d:IsA("ValueBase") then
            if d.Name == "Mutation" and not mutation then
                mutation = tostring(d.Value)
            end
            if d.Name == "Traits" and not trait then
                trait = tostring(d.Value)
            end
            if mutation and trait then break end  -- Early exit
        end
    end
    
    -- Fallback: parse mutation from name
    if not mutation then
        mutation = obj.Name:match("%[(.-)%]") or obj.Name:match("%((.-)%)")
    end
    
    return mutation, trait
end

local function computeIncome(baseIncome, mutation, traitString)
    local base = tonumber(baseIncome) or 0
    mutation = normalizeMutation(mutation)
    local mMult = mutationMultipliers[mutation] or 1
    local rawTraits = parseTraits(traitString)
    local displayTraits, seen = {}, {}
    
    -- Collect all multipliers (mutation + traits) into one list
    local allMultipliers = {mMult}
    
    for _, rawTrait in ipairs(rawTraits) do
        local tName = traitAliases[rawTrait] or rawTrait
        local tMult = traits[tName]
        if tMult then table.insert(allMultipliers, tMult) end
        if not seen[tName] then
            seen[tName] = true
            table.insert(displayTraits, tName)
        end
    end
    
    -- Sort all multipliers descending (highest first)
    table.sort(allMultipliers, function(a,b) return a > b end)
    
    -- Stacking formula: First at full value, rest add (value - 1)
    -- Example: Strawberry (8x) + Taco (3x) = 8 + (3-1) = 10x
    local totalMultiplier = allMultipliers[1]
    for i = 2, #allMultipliers do
        totalMultiplier = totalMultiplier + (allMultipliers[i] - 1)
    end
    
    return math.floor(base * totalMultiplier), displayTraits
end

--// LOOKUP SET
local brainrotSet = {}
for _, n in ipairs(brainrots) do
    brainrotSet[normalizeKey(n)] = true
end

local function normalizeMap(map)
    local out = {}
    for k, v in pairs(map) do out[normalizeKey(k)] = v end
    return out
end

rarityByName = normalizeMap(rarityByName)
costByName = normalizeMap(costByName)
incomeByName = normalizeMap(incomeByName)

local newPing = {}
for name,_ in pairs(PING_NAMES) do newPing[normalizeKey(name)] = true end
PING_NAMES = newPing

-- Forward declaration for Firebase function
local getAllBrainrotsForFirebase

--// FIREBASE COLLECTION FUNCTION
-- Collects ALL brainrots in the server for Firebase (ignores deduplication)
getAllBrainrotsForFirebase = function()
    local allBrainrots = {}
    local seen = {}  -- Deduplicate within server
    
    for _, plot in ipairs(plotsFolder:GetChildren()) do
        for _, obj in ipairs(plot:GetDescendants()) do
            if obj:IsA("Model") then
                local displayName = normalizeBrainrotName(obj.Name)
                local cleanName = normalizeKey(displayName)
                
                if brainrotSet[cleanName] then
                    local mutation, trait = getMutationAndTrait(obj)
                    local key = cleanName .. "|" .. (mutation or "None") .. "|" .. (trait or "None")
                    
                    -- Deduplicate within server (not per-plot)
                    if not seen[key] then
                        seen[key] = true
                        
                        local rarity = rarityByName[cleanName] or "Unknown"
                        local cost = costByName[cleanName] or 0
                        local baseIncome = incomeByName[cleanName] or 0
                        local finalIncome, traitList = computeIncome(baseIncome, mutation, trait)
                        
                        -- Only include if >= 10m (Firebase filter)
                        if finalIncome >= 10000000 then
                            local traitText = (#traitList > 0) and table.concat(traitList, ", ") or "None"
                            local mutationText = mutation or "None"
                            
                            table.insert(allBrainrots, {
                                name = displayName,
                                rarity = rarity,
                                mutation = mutationText,
                                traits = traitText,
                                income = finalIncome,
                                cost = cost
                            })
                        end
                    end
                end
            end
        end
    end
    
    return allBrainrots
end

--// WEBHOOK ONLY MODE (Gist handled by Master Bot)

-- Forward declarations
local scanPlot
local serverHop
local checkServerFull
local sendWebhookGrouped
local queueWebhookSend

--// WEBHOOK FUNCTIONS
local MAX_FIELDS_PER_EMBED = 25
local MAX_EMBEDS_PER_MESSAGE = 10
local reported = {}
local scanQueued = {}
local plotConns = {}
local globalFound = {}
local globalFoundKeys = {}  -- Hash set for O(1) deduplication lookup
local webhookTimer = nil

-- Safe call wrapper for consistent error handling
local function safeCall(label, fn, ...)
    local ok, err = pcall(fn, ...)
    if not ok then
        warn(string.format("[ERROR] %s failed: %s", label, tostring(err)))
    end
    return ok
end

local function chunkArray(arr, chunkSize)
    local out = {}
    for i = 1, #arr, chunkSize do
        local chunk = {}
        for j = i, math.min(i + chunkSize - 1, #arr) do
            table.insert(chunk, arr[j])
        end
        table.insert(out, chunk)
    end
    return out
end

function sendWebhookGrouped(entries)
    print("[DEBUG] sendWebhookGrouped called with", #entries, "entries")
    if type(entries) ~= "table" or #entries == 0 then 
        print("[DEBUG] No entries to send")
        return 
    end
    
    local req = getRequest()
    if not req then
        warn("[Webhook] No request function found")
        warn("[DEBUG] Available functions: syn=", syn ~= nil, "http=", http ~= nil, "http_request=", http_request ~= nil, "request=", request ~= nil)
        return
    end
    print("[DEBUG] Request function found:", req)
    
    -- No deduplication needed - globalFoundKeys already handles this in scanPlot
    print("[Webhook] Processing", #entries, "entries (pre-deduplicated)")
    
    -- Debug: Print first entry
    if #entries > 0 then
        local first = entries[1]
        print("[DEBUG] First entry - Income:", first.income, "IsPing:", first.isPingName, "Line:", first.line:sub(1, 50))
    end
    
    local webhook1Entries = {}
    local webhook2Entries = {}
    local webhook3Entries = {}
    
    for _, e in ipairs(entries) do
        local income = e.income or 0
        local isPingName = e.isPingName or false

        -- Webhook 1: 10m-49.99m only, never ping names
        if income >= MIN_INCOME and income < MID_THRESHOLD and not isPingName then
            table.insert(webhook1Entries, e)
        end

        -- Webhook 2: 50m+ (all of them, no upper cap)
        if income >= MID_THRESHOLD or isPingName then
            table.insert(webhook2Entries, e)
        end

        -- Webhook 3: 800m+ income only (always @everyone)
        if income >= BILLION_THRESHOLD then
            table.insert(webhook3Entries, e)
        end
    end
    
    local t = os.date("!*t")
    local timestamp = string.format("%04d-%02d-%02dT%02d:%02d:%02dZ", t.year, t.month, t.day, t.hour, t.min, t.sec)
    local playerCount = #Players:GetPlayers()
    
    local function buildAndSend(bucket, targetUrl, webhookName, shouldPing)
        if #bucket == 0 then return end
        
        local groups = {}
        for _, e in ipairs(bucket) do
            local r = e.rarity or "Unknown"
            groups[r] = groups[r] or {}
            table.insert(groups[r], e)
        end
        
        local rarities = {}
        for r,_ in pairs(groups) do table.insert(rarities, r) end
        table.sort(rarities, function(a,b) return (RARITY_ORDER[a] or 0) > (RARITY_ORDER[b] or 0) end)
        
        local allEmbeds = {}
        
        for _, rarity in ipairs(rarities) do
            local group = groups[rarity]
            table.sort(group, function(a,b) return (a.income or 0) > (b.income or 0) end)
            
            local brainrotFields = {}
            for _, e in ipairs(group) do
                table.insert(brainrotFields, {
                    name = clampStr(("ðŸ’µ %s/s"):format(short(e.income)), 256),
                    value = clampStr(e.line, 1024),
                    inline = false
                })
            end
            
            local PER_EMBED_BRAINROT_FIELDS = MAX_FIELDS_PER_EMBED - 2
            local fieldChunks = chunkArray(brainrotFields, PER_EMBED_BRAINROT_FIELDS)
            
            for idx, fchunk in ipairs(fieldChunks) do
                table.insert(fchunk, {
                    name = "Server ID",
                    value = "```" .. game.JobId .. "```",
                    inline = false
                })
                
                table.insert(allEmbeds, {
                    title = (#fieldChunks > 1) and ("Found Brainrots â€” %s (%d/%d)"):format(rarity, idx, #fieldChunks) or ("Found Brainrots â€” %s"):format(rarity),
                    url = "https://www.roblox.com/games/start?placeId=109983668079237&gameInstanceId="..game.JobId,
                    description = "",
                    color = RARITY_COLOR[rarity] or RARITY_COLOR["Unknown"],
                    thumbnail = {url = "https://static.wikia.nocookie.net/stealabr/images/e/e3/Tung_Tung_Tung_Sahur.png/revision/latest?cb=20260125163843"},
                    footer = {text = "Cly Notify" .. " | " .. tostring(playerCount) .. "/8ðŸ‘¤"},
                    fields = fchunk,
                    timestamp = timestamp
                })
            end
        end
        
        local embedBatches = chunkArray(allEmbeds, MAX_EMBEDS_PER_MESSAGE)
        
        for i, embedBatch in ipairs(embedBatches) do
            local payload = {
                content = (i == 1 and shouldPing) and "@everyone" or "",
                username = "Cly Notify",
                avatar_url = "https://assets.teenvogue.com/photos/5d4daf13b068cf00080a03f7/16:9/w_2560%2Cc_limit/00-story-diddy.jpg",
                embeds = embedBatch,
                allowed_mentions = (i == 1 and shouldPing) and { parse = {"everyone"} } or { parse = {} }
            }
            
            local success, res = pcall(function()
                return req({
                    Url = targetUrl,
                    Method = "POST",
                    Headers = { ["Content-Type"] = "application/json" },
                    Body = HttpService:JSONEncode(payload)
                })
            end)
            
            if success and res then
                print("[Webhook] Sent to", webhookName, "| Status:", res.StatusCode, "| Items:", #bucket)
            else
                warn("[Webhook] Failed:", res)
                -- Send error to error log webhook
                pcall(function()
                    req({
                        Url = WEBHOOK_ERROR,
                        Method = "POST",
                        Headers = { ["Content-Type"] = "application/json" },
                        Body = HttpService:JSONEncode({
                            content = "âš ï¸ " .. player.Name,
                            embeds = {{
                                title = "Webhook Error: " .. webhookName,
                                description = "```" .. tostring(res) .. "```\n\nServer: " .. game.JobId,
                                color = 0xFF0000,
                                timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
                            }}
                        })
                    })
                end)
            end
            
            if i < #embedBatches then task.wait(0.35) end
        end
    end
    
    -- Webhook 1: 10m-50m (no ping)
    print("[DEBUG] WH1 entries:", #webhook1Entries)
    if #webhook1Entries > 0 then
        buildAndSend(webhook1Entries, WEBHOOK_1, "WH1 (10m-50m)", false)
        task.wait(0.5)
    end
    
    -- Webhook 2: ping if (isPingName AND income >= 80m) OR income >= 200m
    local shouldPingWH2 = false
    for _, e in ipairs(webhook2Entries) do
        if (e.isPingName and e.income >= 80000000) or e.income >= HIGH_THRESHOLD then
            shouldPingWH2 = true
            break
        end
    end
    print("[Webhook] WH2 has", #webhook2Entries, "items. Ping:", shouldPingWH2)
    buildAndSend(webhook2Entries, WEBHOOK_2, "WH2 (50m+)", shouldPingWH2)
    if #webhook2Entries > 0 then task.wait(0.5) end

    -- Webhook 3: 800m+ only, always ping
    print("[Webhook] WH3 has", #webhook3Entries, "items (800m+). Always ping: true")
    buildAndSend(webhook3Entries, WEBHOOK_3, "WH3 (800m+)", true)
    
    -- Upload to Firebase after all webhooks sent (10m+ only)
    if FIREBASE_ENABLED and #entries > 0 then
        print("[Firebase] ðŸ”„ Starting upload process...")
        print("[Firebase] DEBUG: FIREBASE_ENABLED =", FIREBASE_ENABLED)
        print("[Firebase] DEBUG: Current time =", os.time())
        print("[Firebase] DEBUG: Server JobId =", game.JobId)
        print("[Firebase] DEBUG: Using", #entries, "brainrots from webhook entries")
        
        -- Use the brainrots that were already found (from entries)
        -- No need to re-scan the server, which might fail if plots changed
        local allBrainrots = entries
        print("[Firebase] DEBUG: Total brainrots to upload =", #allBrainrots)
        
        print("[Firebase] DEBUG: Proceeding with upload of", #allBrainrots, "brainrots")
        
        -- IMPORTANT: Upload synchronously (not in task.spawn) to prevent cancellation on hop
        do
            print("[Firebase] DEBUG: Getting request function...")
            local req = getRequest()
            if not req then
                warn("[Firebase] âŒ No request function found")
                warn("[Firebase] DEBUG: Available functions - syn:", syn ~= nil, "http:", http ~= nil, "http_request:", http_request ~= nil, "request:", request ~= nil)
                print("[Firebase] DEBUG: Exiting Firebase upload (no request function)")
                return
            end
            print("[Firebase] âœ… Request function found:", tostring(req))
            
            -- Build brainrots array from webhook entries
            print("[Firebase] DEBUG: Building brainrots array...")
            local brainrotsArray = {}
            for i, entry in ipairs(allBrainrots) do
                -- Entries already have all the data we need
                local brainrot = {
                    name = entry.name or "Unknown",
                    rarity = entry.rarity or "Unknown",
                    mutation = entry.mutation or "None",
                    traits = entry.traits or "None",
                    income = entry.income or 0,
                    cost = entry.cost or 0,
                    serverId = game.JobId,
                    foundAt = os.time(),
                    playerCount = #Players:GetPlayers()
                }
                table.insert(brainrotsArray, brainrot)
                
                -- Debug first entry
                if i == 1 then
                    print("[Firebase] DEBUG: First brainrot data:")
                    print("  - Name:", brainrot.name)
                    print("  - Rarity:", brainrot.rarity)
                    print("  - Income:", brainrot.income)
                    print("  - Mutation:", brainrot.mutation)
                    print("  - Traits:", brainrot.traits)
                end
            end
            print("[Firebase] ðŸ“¦ Built array with", #brainrotsArray, "brainrots")
            print("[Firebase] DEBUG: Array building complete")
            
            -- Build Firebase payload
            print("[Firebase] DEBUG: Building Firebase payload...")
            local payload = {
                jobId = game.JobId,
                placeId = game.PlaceId,
                timestamp = os.time(),
                playerCount = #Players:GetPlayers(),
                brainrots = brainrotsArray
            }
            print("[Firebase] ðŸ“‹ Payload structure:")
            print("  - jobId:", payload.jobId)
            print("  - placeId:", payload.placeId)
            print("  - timestamp:", payload.timestamp)
            print("  - playerCount:", payload.playerCount)
            print("  - brainrots count:", #payload.brainrots)
            print("[Firebase] DEBUG: Payload building complete")
            
            -- Upload to Firebase
            print("[Firebase] DEBUG: Constructing Firebase URL...")
            local firebaseUrl = FIREBASE_URL .. "/" .. game.JobId .. ".json"
            print("[Firebase] ðŸŒ Target URL:", firebaseUrl)
            print("[Firebase] DEBUG: Base URL:", FIREBASE_URL)
            print("[Firebase] DEBUG: JobId:", game.JobId)
            
            print("[Firebase] DEBUG: Encoding payload to JSON...")
            local jsonBody = HttpService:JSONEncode(payload)
            print("[Firebase] ðŸ“ JSON body length:", #jsonBody, "characters")
            print("[Firebase] ðŸ“ JSON preview:", jsonBody:sub(1, 200) .. "...")
            print("[Firebase] DEBUG: JSON encoding complete")
            
            print("[Firebase] ðŸš€ Sending PUT request...")
            print("[Firebase] DEBUG: Calling request function...")
            local success, response = pcall(function()
                return req({
                    Url = firebaseUrl,
                    Method = "PUT",
                    Headers = { ["Content-Type"] = "application/json" },
                    Body = jsonBody
                })
            end)
            
            print("[Firebase] DEBUG: Request completed, processing response...")
            
            if success then
                print("[Firebase] DEBUG: pcall succeeded")
                if response and response.StatusCode then
                    print("[Firebase] âœ… Upload successful!")
                    print("[Firebase] ðŸ“Š Status Code:", response.StatusCode)
                    print("[Firebase] ðŸ“Š Response Body:", response.Body and response.Body:sub(1, 200) or "(empty)")
                    print(string.format("[Firebase] âœ… Uploaded %d brainrots to Firebase", #brainrotsArray))
                    print("[Firebase] DEBUG: Upload process complete")
                else
                    warn("[Firebase] âš ï¸ Request succeeded but response is invalid")
                    warn("[Firebase] DEBUG: response =", response)
                    warn("[Firebase] DEBUG: response type:", type(response))
                end
            else
                warn("[Firebase] âŒ Upload failed with error:")
                warn("[Firebase] ERROR:", tostring(response))
                warn("[Firebase] DEBUG: pcall failed")
            end
            
            print("[Firebase] DEBUG: Firebase upload section complete")
        end
    else
        if not FIREBASE_ENABLED then
            print("[Firebase] â¸ï¸ Firebase disabled (FIREBASE_ENABLED = false)")
        elseif #entries == 0 then
            print("[Firebase] â¸ï¸ No entries to upload")
        end
    end
end

function queueWebhookSend(isHighValue)
    print("[DEBUG] queueWebhookSend called, globalFound:", #globalFound, "highValue:", isHighValue or false)
    
    if webhookTimer then
    pcall(task.cancel, webhookTimer)  -- add pcall
    webhookTimer = nil
    print("[DEBUG] Cancelled existing timer")
    end
    
    -- If high value, give time for ALL plots to finish scanning (3s > 0.2s debounce)
    local delay = isHighValue and 3 or SEND_DELAY
    
    webhookTimer = task.delay(delay, function()
        webhookTimer = nil
        print("[DEBUG] Timer fired, globalFound:", #globalFound)
        if #globalFound == 0 then 
            print("[DEBUG] No items to send")
            return 
        end
        
        print("[Webhook] Sending batch of", #globalFound, "items")
        safeCall("sendWebhookGrouped", sendWebhookGrouped, globalFound)
        
        table.clear(globalFound)
        table.clear(globalFoundKeys)  -- Clear hash set too
        
        -- NOW hop, only after webhook sent and all plots scanned
        if pendingHighValueHop and not isHopping then
            pendingHighValueHop = false
            print("[HOP] ðŸš€ Webhook sent - now hopping!")
            task.delay(0.5, function()  -- Brief buffer for HTTP to complete
                serverHop("High Value Brainrot")
            end)
        end
    end)
    
    print("[DEBUG] Timer set for", delay, "seconds")
end

--// SERVER HOP SYSTEM
local function checkForBots()
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= player and BOT_USERNAMES[p.Name] then
            print(string.format("[HOP] ðŸ¤– Bot detected: %s - Hopping immediately!", p.Name))
            return true
        end
    end
    return false
end

function serverHop(reason)
    -- Prevent multiple simultaneous hop attempts
    if isHopping then
        print("[HOP] âš ï¸ Already hopping, ignoring duplicate request")
        return
    end
    isHopping = true
    
    -- Safety timeout: reset isHopping after 10s in case teleport fails
    task.delay(10, function()
        if isHopping then
            warn("[HOP] âš ï¸ Hop timeout - resetting isHopping flag")
            isHopping = false
        end
    end)
    
    print(string.format("\nðŸ”„ [HOP] Initiating server hop... Reason: %s", reason or "Timer"))
    
    -- Cancel hop timer (safely handle if it's already running)
    if currentHopTimer then
    pcall(task.cancel, currentHopTimer)  -- pcall directly on task.cancel, not wrapped
    currentHopTimer = nil
    end
        
    -- Cancel any pending webhook timer and send immediately
    if webhookTimer then
    pcall(task.cancel, webhookTimer)
        webhookTimer = nil
        print("[HOP] Cancelled pending webhook timer")
        
        -- Send any pending webhooks first
        if #globalFound > 0 then
            print("[HOP] Sending pending webhooks before hopping...")
            safeCall("sendWebhookGrouped", sendWebhookGrouped, globalFound)
            table.clear(globalFound)
            table.clear(globalFoundKeys)  -- Clear hash set too
            task.wait(0.5)  -- Brief wait for HTTP request to complete
        end
    end
    
    -- Clean up all connections and memory
    print("[HOP] Cleaning up connections...")
    for plot, conn in pairs(plotConns) do
        if conn then
            pcall(function() conn:Disconnect() end)
        end
    end
    table.clear(plotConns)
    table.clear(reported)
    table.clear(scanQueued)
    table.clear(globalFound)
    table.clear(globalFoundKeys)  -- Clear hash set too
    
    -- Attempt server hop with fallback
    local success, errorMsg = pcall(function()
        local placeId = game.PlaceId
        local serverObjects = {}  -- Store full server objects, not just IDs
        
        print("[HOP] Fetching server list...")
        
        -- Try to get server list with timeout
        local listSuccess = pcall(function()
            local cursor = ""
            local attempts = 0
            local maxAttempts = 2
            
            repeat
                attempts += 1
                if attempts > maxAttempts then break end
                
                local url = string.format(
                    "https://games.roblox.com/v1/games/%d/servers/Public?sortOrder=Asc&limit=100&cursor=%s",
                    placeId, cursor
                )
                
                local response = game:HttpGet(url)
                local data = HttpService:JSONDecode(response)
                
                if data and data.data then
                    for _, server in ipairs(data.data) do
                        if server.id ~= game.JobId and server.playing < server.maxPlayers then
                            table.insert(serverObjects, {
                                id = server.id,
                                playing = server.playing,
                                maxPlayers = server.maxPlayers
                            })
                        end
                    end
                    cursor = data.nextPageCursor or ""
                else
                    break
                end
            until cursor == "" or #serverObjects >= 50
        end)
        
        if listSuccess and #serverObjects > 0 then
            -- Priority 1: High-population servers (5+ players, most active)
            local highPopServers = {}
            for _, server in ipairs(serverObjects) do
                if server.playing >= 4 then
                    table.insert(highPopServers, server)
                end
            end
            
            if #highPopServers > 0 then
                -- Sort by highest population first (most active plots)
                table.sort(highPopServers, function(a, b)
                    return a.playing > b.playing
                end)
                
                -- Pick randomly from top 5 high-pop servers
                local pick = highPopServers[math.random(1, math.min(5, #highPopServers))]
                print(string.format("[HOP] Found %d high-pop servers. Joining server with %d/%d players...", 
                    #highPopServers, pick.playing, pick.maxPlayers))
                TeleportService:TeleportToPlaceInstance(placeId, pick.id, player)
            else
                -- Priority 2: Any open server from the list
                local pick = serverObjects[math.random(1, #serverObjects)]
                print(string.format("[HOP] No high-pop servers. Joining server with %d/%d players...", 
                    pick.playing, pick.maxPlayers))
                TeleportService:TeleportToPlaceInstance(placeId, pick.id, player)
            end
        else
            -- Priority 3: Blind rejoin (last resort)
            warn("[HOP] Server list failed or empty, using simple rejoin...")
            TeleportService:Teleport(placeId, player)
        end
    end)
    
    if not success then
        warn("[HOP] Critical error:", errorMsg)
        -- Last resort: simple teleport
        pcall(function()
            TeleportService:Teleport(game.PlaceId, player)
        end)
    end
end

function checkServerFull()
    local playerCount = #Players:GetPlayers()
    return playerCount >= MAX_PLAYERS
end

-- Start 1-minute hop timer
local function startHopTimer()
    if currentHopTimer then
        pcall(task.cancel, currentHopTimer)  -- use pcall here too
    end
    currentHopTimer = task.delay(HOP_INTERVAL, function()
        currentHopTimer = nil
        print("[HOP] â° 1-minute timer expired")
        serverHop("Timer")
    end)
end

task.wait(0.1)
startHopTimer()
print("[HOP] âœ… Started: 1-minute hop interval")

-- DON'T hop on startup if bots detected - let them coexist
-- Only hop if a NEW bot joins while we're already in the server
print("[HOP] â„¹ï¸ Startup: Allowing bots to coexist in same server")
if checkForBots() then
    print("[HOP] â„¹ï¸ Other bots detected on startup, but staying to scan")
end

-- Monitor for new players (bots) - hop if someone NEW joins
Players.PlayerAdded:Connect(function(newPlayer)
    task.wait(0.5)
    if BOT_USERNAMES[newPlayer.Name] then
        print(string.format("[HOP] ðŸ¤– Bot joined AFTER startup: %s - Hopping!", newPlayer.Name))
        serverHop("Bot Joined")
    end
end)

--// SCANNING
function scanPlot(plot)
    if not plot or not plot.Parent then return end
    reported[plot] = reported[plot] or {}

    local foundList = {}
    local shouldHopImmediate = false
    local descendants = plot:GetDescendants()
    
    for i, obj in ipairs(descendants) do
        if i % 50 == 0 then task.wait() end  -- Yield every 50 objects
        if obj:IsA("Model") then
            local displayName = normalizeBrainrotName(obj.Name)
            local cleanName = normalizeKey(displayName)

            if brainrotSet[cleanName] then
                local mutation, trait = getMutationAndTrait(obj)

                local key = cleanName .. "|" .. (mutation or "None") .. "|" .. (trait or "None")
                if not reported[plot][key] then
                    reported[plot][key] = true

                    local rarity = rarityByName[cleanName] or "Unknown"
                    local cost = costByName[cleanName] or 0
                    local baseIncome = incomeByName[cleanName] or 0

                    local finalIncome, traitList = computeIncome(baseIncome, mutation, trait)
                    
                    print("[DEBUG] Found:", displayName, "Income:", finalIncome, "Min:", MIN_INCOME, "Passes:", finalIncome >= MIN_INCOME)
                    
                    if finalIncome >= MIN_INCOME then
                        local traitText = (#traitList > 0) and table.concat(traitList, ", ") or "None"
                        local mutationText = mutation or "None"
                        local isPingName = PING_NAMES[cleanName] or false
                        
                        print("[DEBUG] Adding to queue:", displayName, "Income:", short(finalIncome))

                        if isPingName or finalIncome >= HIGH_VALUE_THRESHOLD then
                            shouldHopImmediate = true
                            print(string.format(
                                "[HOP] ðŸš¨ HIGH VALUE: %s (%.0fm/s) - Will hop after webhook!",
                                displayName, finalIncome / 1000000
                            ))
                        end

                        local label = ("**%s** | **%s** | ðŸ§¬ **%s** | ðŸ’° **$%s** | ðŸŒ€ **%s**")
                            :format(displayName, rarity, mutationText, short(cost), traitText)

                        -- Create unique key for global deduplication
                        local globalKey = plot.Name .. "|" .. key
                        
                        -- O(1) hash set lookup instead of O(n) linear search
                        if not globalFoundKeys[globalKey] then
                            globalFoundKeys[globalKey] = true  -- Mark as seen
                            table.insert(foundList, {
                                name = displayName,
                                rarity = rarity,
                                mutation = mutationText,
                                traits = traitText,
                                income = finalIncome,
                                cost = cost,
                                line = label,
                                isPingName = isPingName,
                                globalKey = globalKey
                            })
                        end
                    end
                end
            end
        end
    end

    if #foundList > 0 then
        for _, line in ipairs(foundList) do
            table.insert(globalFound, line)
        end
        
        print(string.format("[Scanner] âœ… Found %d brainrots in %s", #foundList, plot.Name))
        
        -- Don't hop yet - just flag it. Webhook sender will hop after sending.
        if shouldHopImmediate then
            print("[HOP] ðŸš¨ High value flagged - will hop AFTER all webhooks sent")
            pendingHighValueHop = true  -- Set flag, don't hop now
        end
        
        -- Queue webhook with priority flag
        queueWebhookSend(shouldHopImmediate)
        
        -- Server full check (lower priority, longer delay to let scans finish)
        if not shouldHopImmediate and checkServerFull() and not isHopping then
            task.delay(3, function()
                if not isHopping then
                    serverHop("Server Full")
                end
            end)
        end
    end
end
--// PLOT HOOKING & INITIALIZATION
local function hookPlot(plot)
    if plotConns[plot] then
        plotConns[plot]:Disconnect()
        plotConns[plot] = nil
    end
    
    -- Initial scan (parallel)
    task.spawn(function()
        safeCall("scanPlot", scanPlot, plot)
    end)
    
    -- Fast DescendantAdded - only scan if it's actually a brainrot
    plotConns[plot] = plot.DescendantAdded:Connect(function(newObj)
        -- Quick filter: only care about Models
        if not newObj:IsA("Model") then return end
        
        local rawName = newObj.Name
        if #rawName < 3 or #rawName > 60 then return end
        
        local cleanName = normalizeKey(normalizeBrainrotName(rawName))
        if not brainrotSet[cleanName] then return end
        
        -- Cancel existing queued scan and restart timer
       -- In hookPlot's DescendantAdded:
        if scanQueued[plot] then
        pcall(task.cancel, scanQueued[plot])  -- add pcall
        scanQueued[plot] = nil
        end
        
        -- Store task handle (not boolean) so we can cancel it
        scanQueued[plot] = task.delay(0.2, function()
            scanQueued[plot] = nil
            if plot and plot.Parent then
                safeCall("scanPlot", scanPlot, plot)
            end
        end)
    end)
end

-- Parallel initial hookup of all plots with yielding
for i, plot in ipairs(plotsFolder:GetChildren()) do
    task.spawn(function()
        safeCall("hookPlot", hookPlot, plot)
    end)
    if i % 2 == 0 then task.wait() end  -- Yield every 2 plots
end

plotsFolder.ChildAdded:Connect(function(plot)
    task.delay(0.1, function()
        safeCall("hookPlot", hookPlot, plot)
    end)
end)

plotsFolder.ChildRemoved:Connect(function(plot)
    reported[plot] = nil
    scanQueued[plot] = nil
    if plotConns[plot] then
        plotConns[plot]:Disconnect()
        plotConns[plot] = nil
    end
end)

print("[Scanner] âœ… Initialized!")
print("[HOP] ðŸ“‹ Rules: 1min timer | Immediate on high value | Immediate on server full | Immediate on bot detection")
print("[Webhook] ðŸ“‹ Distribution: WH1=10m-50m (no ping) | WH2=50m+ (ping if pingnameâ‰¥80m or â‰¥200m) | WH3=800m+ (always @everyone)")
